 <!DOCTYPE html>
<html>
<head>
    <title>Elaw.my</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.3.0.min.css" />
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/jquery.mobile-1.3.0.min.js"></script>
    <script>
    </script>
   
</head>
<body>
 <div data-role="page" id="caseMain">

        <div data-role="header" data-position="fixed" data-id="header1" data-tap-toggle="false">
            <h1 data-theme="e">Elaw.my</h1>
            <a id="linkback" href="searchItems.html" data-icon="arrow-l" data-theme="b">Back</a>
            <a href="index.html" data-icon="gear" class="ui-btn-right" data-theme="b">Home</a>  
        </div><!-- /header -->
         <div data-role="content">
           <div id="results">
           	
           </div>
       </div> <!-- ending content -->
        <div data-role="footer" data-tap-toggle="false" data-id="footer1" data-position="fixed">        
            <div data-role="navbar">
                <ul id="footerList">
                    <li><a link="latest.html" data-icon="star">Latest</a></li>
                    <li><a link="caseSearch.html" data-icon="search" class="" id="caseSearchLink" data-theme="b">Cases</a></li>
                    <li><a link="legislationSearch.html" data-icon="search">Legislation</a></li>
                    <li><a href="#popupMenu" data-rel="popup" data-role="button" data-inline="true" data-icon="gear">More</a></li>
                </ul>
            </div><!-- /navbar -->
        </div><!-- /footer --> 
         <div data-role="popup" id="popupMenu" id="footerlist2">
            <ul data-role="listview" data-inset="true" style="min-width:210px;">
                <li><a href="references.html">References</a></li>
                <li><a href="help.html">Help</a></li>                            
            </ul>
        </div>        
        
    <script>
    $("#caseMain li a").on('vclick',function(){
        //console.log();
        var url = $(this).attr('link');
        if(url)
            $.mobile.changePage(url);
    });
    function makeUrl(p){
        var filename = $.filename;
        //var ec = $.urlParam('ec');
        var url = 'http://elaw.com.my/Elawf4/mobile/searchresultmobile.aspx?filename='+filename;
        var page = '';
        $.casePage += 1;
        page = $.casePage;           
        url += '&p='+page;
        url += '&callback=?';
        //console.log(url);
        return url;
    }
    function runIt(){
        $.casePage = 0;
        $.scrollAndLoad = true;
        var urltext = makeUrl();
        $.mobile.loading('show');
        $.getJson(urltext,'caseMain');
        $(window).on('scroll',function(){
            if($.mobile.activePage.attr('id') == 'caseMain'){
                if($(window).scrollTop() + $(window).height() >= $(document).height()){
                    if($.scrollAndLoad){                
                        url = makeUrl();
                        console.log(url);
                        if($.casePage <= $.lastPage){
                            $.getJson(url,'caseMain');
                            $.mobile.loading('show');
                        }                        
                        $.scrollAndLoad = false;
                        //$(window).height() -= 20;
                        
                    }                
                }
            }    
        });
    }
    function runIt2(){
        if($.latest){
            $("#linkback").attr('href','latest.html');
            $.latest=false;
            console.log($.latest);
            console.log($("#linkback").attr('href'));
        }
    }
    $('#caseMain').on('pageshow', runIt);  
    $('#caseMain').on('pageinit', runIt2);  
    </script>
    </div>
</body>
<html>
