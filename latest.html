<!DOCTYPE html>
<html>
<head>
    <title>Elaw.my</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
    <link rel="stylesheet" href="css/jquery.mobile-1.3.0.min.css" />
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/jquery.mobile-1.3.0.min.js"></script>   
</head>
<body>
    <div data-role="page" id="latestCases">

        <div data-role="header" data-id="header1" data-position="fixed" data-tap-toggle="false">
            <h1 data-theme="e">Elaw.my</h1>
            <a href="index.html" data-icon="home" data-theme="b">Home</a>
            <a href="help.html" data-icon="gear" class="ui-btn-right" data-theme="b">Help</a>  
        </div><!-- /header -->   
        <div data-role="content">                
            <h3 align="center">
                Latest cases
            </h3>
        <div style="margin-bottom: 20px;">
        <select name="court" id="courts" style="margin-bottom: 50px;" data-native-menu="false" data-mini="true">
            <option value="ac" page=1 selected="selected">All courts</option>
            <option value="ac" page=4>Appellate Court</option>
            <option value="hc" page=2>High Court</option>
            <option value="ic" page=3>Industrial Court</option>            
        </select>
        </div>
        <div id="aac"><div data-role="listview" id="aaclist"></div></div>
        <div id="hc"><div data-role="listview" id="hclist"></div></div>
        <div id="ic"><div data-role="listview" id="iclist"></div></div>
        <div id="ac"><div data-role="listview" id="aclist"></div></div>
            <div data-role="footer" data-position="fixed" data-id="footer1" data-tap-toggle="false">        
                    <div data-role="navbar">
                        <ul>
                            <li><a link="#" data-icon="star" class="" data-theme="b">Latest</a></li>
                            <li><a link="caseSearch.html" data-icon="search">Cases</a></li>
                            <li><a link="legislationSearch.html" data-icon="search">Legislation</a></li>
                            <li><a href="#popupMenu" data-rel="popup" data-role="button" data-inline="true" data-icon="gear">More</a></li>
                        </ul>
                    </div>
            </div>  
        <div data-role="popup" id="popupMenu" id="footerlist2">
            <ul data-role="listview" data-inset="true" style="min-width:210px;">
                <li><a href="references.html">References</a></li>
                <li><a href="help.html">Help</a></li>                            
            </ul>
        </div>    
        </div> <!-- content ends -->
        <style>
            .ui-li .ui-btn-inner a.ui-link-inherit, .ui-li-static.ui-li {
                padding-top:1px;
                padding-bottom:1px;
            }
        </style>
        <script>
        $("#latestCases li a").on('vclick',function(){
            //console.log();
            var url = $(this).attr('link');
            if(url)
                $.mobile.changePage(url);
        });
        function makeUrl(page){
            var url = 'http://elaw.com.my/Elawf4/mobile/searchresultmobile.aspx?ec=law&page='+page+'&callback=?';
            var html = '';
            $.mobile.loading('show');
            $.fetching = true;
            $.getJSON(url,function(data){
               $.each(data.results,function(index,elem){
                if(index != 'pages'){
                  html += '<li name="'+elem.fileName+'"><a href="#" name="'+elem.fileName+'"><h1>'+elem.title+'</h1><p>'+elem.Court+'</p></a></li>';
                    }                  
                });
               switch(page){
                case 1:
                    $("#hclist,#iclist,#aclist").toggle(false);
                    $("#aaclist").html(html).toggle(true);
                    $("#aaclist").listview('refresh');
                    // $("#aaclist .ui-li").css('padding-top','1px;');
                    break;
                case 2:
                    $("#aaclist,#iclist,#aclist").toggle(false);
                    $('#hclist').html(html).toggle(true);
                    $("#hclist").listview('refresh');
                    break;
                case 3:
                    $("#aaclist,#hclist,#aclist").toggle(false);
                    $('#iclist').html(html).toggle(true);
                    $("#iclist").listview('refresh');
                    break;
                case 4:
                    $("#aaclist,#iclist,#hclist").toggle(false);
                    $('#aclist').html(html).toggle(true);
                    $("#aclist").listview('refresh');
                    break;
               }
            $.fetching = false;
            $.mobile.loading('hide');
           });
        }
       $("#latestCases").on('pageshow',function(){                
            makeUrl(1);     
       });
       $("#courts").change(function(){
            var page = $("#courts option:selected").attr('page');
            //console.log(page);
            if(!$.fetching)
                makeUrl(parseInt(page));
       });
        </script>
    </div> <!-- page ends here -->
</body>
</html>