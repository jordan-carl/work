 <!DOCTYPE html>
<html>
<head>
    <title>Elaw.my</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.3.0.min.css" />
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/jquery.mobile-1.3.0.min.js"></script>
    <script src="js/purl.js"></script>
   
    <script>
    </script>
   
</head>
<body>
 <div data-role="page" id="caseMain2" data-add-back-btn="true">
 <div data-role="content">
        <div data-role="header" data-position="fixed" data-id="header1" data-tap-toggle="false">
            <h1 data-theme="e">Elaw.my</h1>
            <a id="linkback" href="#" data-icon="arrow-l" data-role="back" data-theme="b">Back</a>
            <a href="options.html" data-icon="gear" class="ui-btn-right" data-theme="b">Options</a>  
        </div><!-- /header -->
       <div id="results">
       	
       </div>
        <div data-role="footer" data-position="fixed" data-id="footer1" data-tap-toggle="false">        
                <div data-role="navbar">
                    <ul id="footerList">
                        <li><a href="latest.html" data-icon="star" class="">Latest</a></li>
                        <li><a href="caseSearch.html" data-icon="search">Cases</a></li>
                        <li><a href="legislationSearch.html" data-icon="search" data-theme="e">Legislation</a></li>
                        <li><a href="references.html" data-icon="info">References</a></li>
                        <li><a href="help.html" data-icon="alert">Help</a></li>
                    </ul>
                </div>
        </div>    
        </div>
    <script>
    $.urlParam = function(name){
    var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if(results)
        return results[1] || 0;		
    else
        return '';
    }
	$("#linkback").bind("click",function(){
		window.history.back();
	});
    function runIt2(){
		$("#footerList a").each(function(){				
				var url = $(this).attr('href');
				url += '?u='+$.urlparam('u');
				$(this).attr('href',url);
		});
        var ec = $.urlParam('ec');
		var referrer =  document.referrer;
        $("#linkback").attr('href',referrer);
        var filename = $.urlParam('filename')
        var part = $.urlParam('part')
        var url = 'http://elaw.com.my/test2/mobile/legislationsearchmobile.aspx?ec='+ec+'&filename='+filename+'&part='+part;
         url += '&callback=?';       
        console.log(url)
        $.getJSON(url,function(data){
                var html = '';
                console.log(data);
                if (data){
					$.each(data.result,function(index,elem){
						//console.log(index);
						//console.log(elem);
						html += '<div data-role="collapsible">';
						html += '<h4 align="center">'+index+' '+elem.SectionTitle+'</h4>';						
						html += '<p>'+elem.SectionContent+'</p>';   
						html += '</div>';
					});                    
                }
                else{
                    html='<h2 align="center">No content to display</h2>'
                }
                
        if(html === ''){
            html = '<li>No results</li>'
            //console.log(html);
        }
        else{
        	$("#results").html(html);
			$("#results").find('div[data-role=collapsible]').collapsible();
		}
              
        });
    }
    $('#caseMain2').on('pageshow', runIt2);
    </script>
    </div>
</body>
<html>